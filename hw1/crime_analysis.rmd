---
title: Crime in Chicago
author: Sinclair Target
output: pdf_document
---

```{python, echo=FALSE}
import numpy as np
import pandas as pd
from pandas import Series, DataFrame
import matplotlib.pyplot as plt
```

```{python}
df_2017 = pd.read_csv('data/crimes2017.csv')
df_2018 = pd.read_csv('data/crimes2018.csv')
```

# Problem 1
## Types of Crime
Across all of Chicago, the most common crime in both 2017 and 2018 was theft.
Other common crimes included battery and assault.

```{python}
crimes_2017 = df_2017.groupby('Primary Type') \
                     .size() \
                     .sort_values(ascending=False).iloc[:5]
crimes_2017

crimes_2018 = df_2018.groupby('Primary Type') \
                     .size() \
                     .sort_values(ascending=False).iloc[:5]
crimes_2018
```

These most common five crimes were the same across both years. Thefts were the
most common crime by quite a ways, as can be seen in the following graphs:

```{python, results = 'hide'}
# 2017
plt.barh(crimes_2017.index.to_numpy(), crimes_2017.values)
plt.title('Most Common Crimes (2017)')
plt.xlabel('Occurrences')
plt.tight_layout()
plt.show()
plt.close()

# 2018
plt.barh(crimes_2018.index.to_numpy(), crimes_2018.values)
plt.title('Most Common Crimes (2018)')
plt.xlabel('Occurrences')
plt.tight_layout()
plt.show()
plt.close()
```

## Crime Over Time
We can see from the graph below that there is a seasonal pattern to crime. Most
crimes, such as theft and battery, spike in the summer. But there are other
crimes such as "deceptive practice" that spike in the winter.

```{python, results = 'hide'}
crimes = ['THEFT', 'ASSAULT', 'BATTERY', 'CRIMINAL DAMAGE', 'DECEPTIVE PRACTICE']

crimes_2018 = df_2018[df_2018['Primary Type'].isin(crimes)]

crimes_2018['Datetime'] = pd.to_datetime(crimes_2018['Date'])
crimes_2018 = (crimes_2018.groupby(['Primary Type', crimes_2018['Datetime'].dt.month])
                          .size()
                          .to_frame('Count')
                          .reset_index())

for crime in crimes:
    these_crimes = crimes_2018[crimes_2018['Primary Type'] == crime]
    plt.plot(these_crimes.Datetime.values, these_crimes.Count.values)

plt.xticks(range(1, 13), ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul',
                          'Aug', 'Sep', 'Oct', 'Nov', 'Dec'])

plt.title('Most Common Crimes Over Year (2018)')
plt.xlabel('Months')
plt.ylabel('Occurrences')
plt.legend(crimes, prop={'size': 6})

plt.show()
plt.close()
```

## Crime Locations
The community areas with the most crime (the 25th, 8th, 32nd, 28th, and 29th)
are all either downtown or on the west side.

```{python}
crimes_2017 = df_2017.groupby('Community Area') \
                     .size() \
                     .sort_values(ascending=False).iloc[:5]
crimes_2017

crimes_2018 = df_2018.groupby('Community Area') \
                     .size() \
                     .sort_values(ascending=False).iloc[:5]
crimes_2018
```

# Problem 2
## Battery
The median "Battery" crime occurs in a census tract that has a relatively low
median household income. The census tract is typically 80% black, 5% Hispanic
or Latino, and has a median age of 33.

```{python}
df = pd.read_csv('data/crimes2018_augmented.csv')
df['black_perc'] = df['black_pop'] / df['total_pop']
df['hispanic_perc'] = df['hispanic_pop'] / df['total_pop']

battery = df[df['Primary Type'] == 'BATTERY'].copy()
battery[battery.household_inc >= 0].household_inc.median()
battery[battery.black_perc >= 0].black_perc.median()
battery[battery.hispanic_perc >= 0].hispanic_perc.median()
battery[battery.median_age >= 0].median_age.median()
```

## Homicide
The median "Homicide" crime occurs in a poorer census tract than the median
"Battery" crime. This census tract is also more black (92%) and less Hispanic
or Latino (4%). The median age is more or less the same.

```{python}
homicide = df[df['Primary Type'] == 'HOMICIDE']
homicide[homicide.household_inc >= 0].household_inc.median()
homicide[homicide.black_perc >= 0].black_perc.median()
homicide[homicide.hispanic_perc >= 0].hispanic_perc.median()
homicide[homicide.median_age >= 0].median_age.median()
```

## Change Over Time
```{python}
battery['Datetime'] = pd.to_datetime(battery['Date'])

battery_jan = battery[battery['Datetime'].dt.month == 1]
battery_dec = battery[battery['Datetime'].dt.month == 12]

battery_jan[battery_jan.household_inc >= 0].household_inc.median()
battery_jan[battery_jan.black_perc >= 0].black_perc.median()
battery_jan[battery_jan.hispanic_perc >= 0].hispanic_perc.median()
battery_jan[battery_jan.median_age >= 0].median_age.median()

battery_dec[battery_dec.household_inc >= 0].household_inc.median()
battery_dec[battery_dec.black_perc >= 0].black_perc.median()
battery_dec[battery_dec.hispanic_perc >= 0].hispanic_perc.median()
battery_dec[battery_dec.median_age >= 0].median_age.median()
```

We can see from the above that there is not much change between the beginning
of 2018 and the end of 2018.

## Deceptive Practice and Sex Offense
```{python}
decept = df[df['Primary Type'] == 'DECEPTIVE PRACTICE']
sex = df[df['Primary Type'] == 'SEX OFFENSE']

decept[decept.household_inc >= 0].household_inc.median()
sex[sex.household_inc >= 0].household_inc.median()
```

One difference is that the median household income in census tracts with lots
of "Deceptive Practice" crimes was significantly higher than the median
household income in census tracts with lots of "Sex Offense" crimes.
